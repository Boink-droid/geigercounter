<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Moonlight Courier Test</title>
  <style>
    body, html {
      margin: 0; padding: 0; overflow: hidden; background: #000011;
    }
    canvas {
      display: block; background: #000011;
    }
  </style>
</head>
<body>
  <canvas id="game"></canvas>
  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const width = window.innerWidth;
    const height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;

    const stars = [];
    for(let i = 0; i < 200; i++) {
      stars.push({x: Math.random()*width, y: Math.random()*height, size: Math.random()*1.5});
    }

    const ship = {
      x: width/2,
      y: height/2,
      angle: 0,
      size: 30,
      vx: 0,
      vy: 0,
      thrust: 0.2,
      maxSpeed: 6,
      trail: []
    };

    const keys = {};

    function drawShip() {
      ctx.save();
      ctx.translate(ship.x, ship.y);
      ctx.rotate(ship.angle);

      ctx.beginPath();
      ctx.moveTo(0, -ship.size / 2);
      ctx.lineTo(ship.size / 2, ship.size / 2);
      ctx.lineTo(-ship.size / 2, ship.size / 2);
      ctx.closePath();
      ctx.fillStyle = '#44aaff';
      ctx.fill();

      ctx.beginPath();
      ctx.moveTo(0, -ship.size / 2);
      ctx.lineTo(7, -ship.size / 2 + 15);
      ctx.lineTo(-7, -ship.size / 2 + 15);
      ctx.closePath();
      ctx.fillStyle = 'red';
      ctx.fill();

      ctx.restore();
    }

    function drawTrail() {
      for (let i = 0; i < ship.trail.length; i++) {
        const p = ship.trail[i];
        ctx.globalAlpha = 1 - i / ship.trail.length;
        ctx.fillStyle = '#44aaff';
        ctx.beginPath();
        ctx.arc(p.x, p.y, 3, 0, Math.PI * 2);
        ctx.fill();
      }
      ctx.globalAlpha = 1;
    }

    function update() {
      const turning = keys['a'] || keys['arrowleft'] || keys['d'] || keys['arrowright'];

      if(keys['w'] || keys['arrowup']) {
        ship.vx += Math.sin(ship.angle) * ship.thrust;
        ship.vy -= Math.cos(ship.angle) * ship.thrust;
      }

      if(keys['a'] || keys['arrowleft']) ship.angle -= 0.06;
      if(keys['d'] || keys['arrowright']) ship.angle += 0.06;

      if(keys['s'] || keys['arrowdown']) {
        ship.vx *= 0.9;
        ship.vy *= 0.9;
      }

      if(keys[' ']) {
        if (turning) {
          ship.vx *= 0.96;
          ship.vy *= 0.96;

          ship.trail.unshift({ x: ship.x, y: ship.y });
          if (ship.trail.length > 15) ship.trail.pop();
        }
      } else {
        ship.trail = [];
      }

      let speed = Math.sqrt(ship.vx * ship.vx + ship.vy * ship.vy);
      if(speed > ship.maxSpeed) {
        ship.vx *= ship.maxSpeed / speed;
        ship.vy *= ship.maxSpeed / speed;
      }

      ship.x += ship.vx;
      ship.y += ship.vy;

      ship.x = Math.min(Math.max(ship.x, 0), width);
      ship.y = Math.min(Math.max(ship.y, 0), height);
    }

    function draw() {
      ctx.clearRect(0, 0, width, height);

      ctx.fillStyle = '#ffffff';
      for(let star of stars) {
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
        ctx.fill();
      }

      drawTrail();
      drawShip();
    }

    function loop() {
      update();
      draw();
      requestAnimationFrame(loop);
    }

    window.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
    window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

    loop();
  </script>
</body>
</html>
